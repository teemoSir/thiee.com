<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>绘制矩形</title>
    <style type="text/css">
        html, body {
            padding: 0;
            margin: 0;
        }

        #container {
            width: 100%;
            height: 100%;
            position: absolute;
        }
    </style>
    <script src="../../Scripts/MapAPI_JavaScript.min.js"></script>
    <script src="../../Scripts/jquery-1.9.1.min.js"></script>
    <link href="../../Content/bootstrap.min.css" rel="stylesheet" />

</head>
<body style="overflow:hidden">
    <div id="container"></div>
    <div class="alert alert-success" style="position:absolute; left:100px; top:20px; ">
        <label>提示：</label><br />
    1.双击矩形触发回调</div>
    <div id="codes" style=" position:absolute; bottom:0; width:100%; height:290px;display:none">
        <table class="table table-condensed">
            <tr><th>代码</th></tr>
            <tr>
                <td>
                    <textarea class="form-control" style="width:100%;height:250px;">
                        <!DOCTYPE html>
                        <html xmlns="http://www.w3.org/1999/xhtml">

                        <head>
                            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
                            <title>绘制矩形</title>
                            <style type="text/css">
                                html, body {
                                    padding: 0;
                                    margin: 0;
                                }

                                #container {
                                    width: 100%;
                                    height: 100%;
                                    position: absolute;
                                }
                            </style>
                            <script src="../MapAPI_JavaScript.min.js"></script>
                        </head>

                        <body>
                            <div id="container"></div>
                            <script type="text/javascript">
                                var option = new TYMapOptions({
                                    contentId: "container",//必填，地图容器
                                    lnglat: new TYLngLat(114.50, 38.000),//可选 默认ip定位
                                    mapLevel: 12//可选默认 12
                                });
                                TYInitialize(option);
                                TYMapConfig(new TYConfigOption());
                                addrect();
                                function addrect() {
                                    var rectangleArr = [];
                                    var rectangle = new TYRectangle();
                                    rectangle.t_r_LngLat = new TYLngLat(113, 38);
                                    rectangle.b_l_LngLat = new TYLngLat(114, 39);
                                    rectangle.rectangleId = "rectangle1";
                                    rectangle.fillColor = "red";
                                    rectangle.isEdit = false;
                                    rectangleArr.push(rectangle);

                                    var rectangle2 = new TYRectangle();
                                    rectangle2.t_r_LngLat = new TYLngLat(113.5, 37);
                                    rectangle2.b_l_LngLat = new TYLngLat(114, 36);
                                    rectangle2.rectangleId = "rectangle2";
                                    rectangle2.fillColor = "red";
                                    rectangle2.isEdit = true;
                                    rectangleArr.push(rectangle2);

                                    var RectangleOption = new TYRectangleOption();
                                    RectangleOption.rectangleData = rectangleArr;
                                    RectangleOption.rectangleState.isSetView = true;
                                    RectangleOption.rectangleState.isClearOverlay = true;

                                    //实例化事件参数
                                    var event = new TYOverlayEvent();
                                    event.mouseEvent = TYEnumEvent.TY_DOUBLECLICK;
                                    event.mouseFunc = clickRectangle;

                                    RectangleOption.rectangleState.overlayEvent = event;//第一个参数为事件类型的枚举，第二个参数是要操作的自定义事件名
                                    TYDrawRectangle(RectangleOption);

                                }

                                TYAddMapEvent(new TYEventOptions({
                                    event: TYEnumEvent.TY_RIGHTCLICK,
                                    callback: addrect
                                }))

                                function clickRectangle(e) {
                                    alert("点击事件触发了回调函数");

                                    console.log(e)
                                }
                            </script>
                        </body>

                    </html>
                </textarea>

            </td>
        </tr>
    </table>
</div>


<div id="codeshow"  data="0"  class="btn btn-default" style="position:absolute; right:20px; top:20px;font-family:Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', '微软雅黑', Arial;"><span class=" glyphicon glyphicon-eye-open"></span> 查看源码</div>


<script>
        $(document).ready(function () {
            $("#codeshow").click(function () {
                var he = $("#container").css("height");
                var hei = he.split("px")[0];
                if ($("#codeshow").attr("data") == "0") {
                    $("#container").css("height", (parseInt(hei) - 300) + "px");
                    $("#codes").css("display", "block")
                    $("#codeshow").removeClass("btn-default").addClass("btn-success");
                    $("#codeshow").attr("data", "1")
                } else {
                    $("#container").css("height", (parseInt(hei) + 300) + "px");
                    $("#codes").css("display", "none")
                    $("#codeshow").removeClass("btn-success").addClass("btn-default");
                    $("#codeshow").attr("data", "0")
                }

            })
        })
</script>
<script type="text/javascript">
    var option = new TYMapOptions({
        contentId: "container",//必填，地图容器
        lnglat: new TYLngLat(114.50, 38.000),//可选 默认ip定位
        mapLevel: 12//可选默认 12
    });
    TYInitialize(option);
    TYMapConfig(new TYConfigOption());
    addrect();
    function addrect() {
        var rectangleArr = [];
        var rectangle = new TYRectangle();
        rectangle.t_r_LngLat = new TYLngLat(113, 38);
        rectangle.b_l_LngLat = new TYLngLat(114, 39);
        rectangle.rectangleId = "rectangle1";
        rectangle.fillColor = "red";
        rectangle.isEdit = false;
        rectangleArr.push(rectangle);

        var rectangle2 = new TYRectangle();
        rectangle2.t_r_LngLat = new TYLngLat(113.5, 37);
        rectangle2.b_l_LngLat = new TYLngLat(114, 36);
        rectangle2.rectangleId = "rectangle2";
        rectangle2.fillColor = "red";
        rectangle2.isEdit = true;
        rectangleArr.push(rectangle2);

        var RectangleOption = new TYRectangleOption();
        RectangleOption.rectangleData = rectangleArr;
        RectangleOption.rectangleState.isSetView = true;
        RectangleOption.rectangleState.isClearOverlay = true;

        //实例化事件参数
        var event = new TYOverlayEvent();
        event.mouseEvent = TYEnumEvent.TY_DOUBLECLICK;
        event.mouseFunc = clickRectangle;

        RectangleOption.rectangleState.overlayEvent = event;//第一个参数为事件类型的枚举，第二个参数是要操作的自定义事件名
        TYDrawRectangle(RectangleOption);

    }

    TYAddMapEvent(new TYEventOptions({
        event: TYEnumEvent.TY_RIGHTCLICK,
        callback:addrect
    }))

    function clickRectangle(e) {
        alert("点击事件触发了回调函数");

        console.log(e)
    }
</script>
</body>
</html>


